<!doctype html>
<html>
<head>
    <base>
    <meta http-equiv="Content-type=text/html;charset=utf-8"/>
    <title>聊天室</title>
    <link rel="stylesheet" href="/stylesheets/bootstrap-theme.css"/>
    <link rel="stylesheet" href="/stylesheets/bootstrap.css"/>
    <link rel="stylesheet" href="/stylesheets/flat-ui.css"/>
    <script language="javascript" src="/javascript/jquery.js"></script>
    <script language="javascript" src="/javascript/bootstrap.js"></script>
    <script language="javascript" src="/socket.io/socket.io.js"></script>
    <script language="javascript" src="/javascript/ajaxuploadfile.js"></script>

    <script language="javascript">
        $(function () {
            var btnUpload = $('#uploadimg');
            new AjaxUpload(btnUpload, {
                action: '/uploadfile',
                name: 'uploadfile',
                onSubmit: function (file, ext) {
                    if (!(ext && /^(jpg|png|jpeg|gif)$/.test(ext))) {
                        window.parent.errortext();
                        return false;
                    }
                },
                onComplete: function (file, response) {
                    console.log(response);
                    eval("var t=" + response);
                    var targetFile = t.targetFile.toString();
                    if (response.error != null) {
                        alert("上传错误" + response.error);
                    } else {
                        // 渲染页面
                        $("#new_img_path").attr("src", targetFile);
                        $("#fileUrl").val(targetFile);
                    }
                }
            });

        });
    </script>
</head>
<body>

<div class="nav navbar-inverse navbar-fixed-top">
    <div class="container">
        <div class="navar header">
            <a class="navbar-brand">ChatRoom</a>
        </div>
    </div>
</div>
<div class="container" style="margin-top: 100px;">
    <form method="post" class="form-horizontal">
        <div >
            <div class="login-screen">
                <div class="login-icon">
                    <img src="/img/login/chat.png" alt="Register your name"/>
                    <h4>Welcome to
                        <small>ChatRoom</small>
                    </h4>
                </div>
                <div class="login-form" style="margin-top:-110px;">
                    <div class="form-group">
                        <input type="text" class="form-control login-field" value="" placeholder="请输入用户名"
                               id="login-name" name="username"/>
                        <label class="login-field-icon fui-user" for="login-name"></label>
                    </div>

                    <div class="form-group">
                        <input type="password" name="password" class="form-control login-field" value=""
                               placeholder="请输入密码" id="login-pass"/>
                        <label class="login-field-icon fui-lock" for="login-pass"></label>
                    </div>

                    <div class="form-group">
                        <input type="password" name="confirm_password" class="form-control login-field" value=""
                               placeholder="请确认密码" id="confirm_password"/>
                        <label class="login-field-icon fui-lock" for="login-pass"></label>
                    </div>

                    <div class="form-group">
                        <input type="text" class="form-control login-field" value="" placeholder="请输入邮箱" id="email"
                               name="email"/>
                        <label class="login-field-icon fui-user" for="login-name"></label>
                    </div>

                    <div class="form-group">
                        <label class="login-field-icon"> 上传头像</label>
                        <input type="file" id="uploadimg" style="margin-left:20px;" >
                        <input type="hidden" value="" name="avatar" id="fileUrl">
                        <img  src="/images/none.png" style="margin-left:20px;" id="new_img_path" width="150" >
                    </div>
                    <a class="btn btn-primary btn-lg btn-block" id="login" href="#">注册</a>
                    <a class="login-link" href="#">忘记密码?</a>
                </div>
            </div>

        </div>
    </form>
</div>
</body>
</html>